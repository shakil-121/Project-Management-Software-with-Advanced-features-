@model List<FastPMS.Models.Domain.Project>
@{
    ViewData["Title"] = "All Projects";
}
 
<html>
<link rel="stylesheet" href="~/css/buttonStyle.css" asp-append-version="true" />
<link rel="stylesheet" href="~/css/error.css" asp-append-version="true" /> 
<link rel="stylesheet" href="~/css/StyleSheet.css" asp-append-version="true" />
<head>
    <style>
        .table-hover tr:hover {
            background-color: #b5e2f6;
        } 
        .listPage{
            margin-top:80px;
        } 
        
    </style>
</head>
<body>  
    <div class="mt-4">
        <div class="card bg-dark text-white shadow mb-3">
            <div class="card-body">
                <h5 class="card-title"><i class='bx bxs-folder'></i> Total Projects</h5>
                <p class="card-text text-light">@ViewBag.TotalProjectsCount Projects</p>
            </div>
        </div>
    </div>
    <div class="mt-3 d-flex justify-content-between"
        <div class="row">
            <div class="col-md-3">
                <div class="card bg-light shadow mb-3">
                    <div class="card-body">
                        <h5 class="card-title"><i class='bx bx-radio-circle-marked'></i>Not Started</h5>
                        <p class="card-text">@ViewBag.NotStartedCount Projects</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 ps-3">
                <div class="card bg-info text-white shadow mb-3">
                    <div class="card-body">
                        <h5 class="card-title"><i class='bx bxs-caret-up-circle'></i>In Progress</h5>
                        <p class="card-text">@ViewBag.InProgressCount Projects</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 ps-3">
                <div class="card bg-warning shadow mb-3">
                    <div class="card-body">
                        <h5 class="card-title"><i class='bx bx-stop-circle'></i>On Hold</h5>
                        <p class="card-text">@ViewBag.OnHoldCount Projects</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 ps-3">
                <div class="card bg-success text-white mb-3">
                    <div class="card-body">
                        <h5 class="card-title"><i class='bx bx-check-square'></i>Completed</h5>
                        <p class="card-text">@ViewBag.CompletedCount Projects</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

<div class="container listPage">
        @{
            if (TempData["SuccessMessage"] != null)
            {
                <div class="alert alert-success" id="success-alert" role="alert">
                    @TempData["SuccessMessage"]
                </div>
            }

        } 
        @{
            if (TempData["updateSuccess"] !=null){
                <div class="alert alert-success" id="success-alert" role="alert">
                    @TempData["updateSuccess"]
                </div>
            }
        }
        <div class="d-flex justify-content-between align-items-center my-3 mx-1">
            <h2 class="">All Projects</h2> 

            <a asp-controller="AdminProject" asp-action="CreateProject" class="text-decoration-none">
                <button class="cssbuttons-io-button">
                    Create New Project
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" viewBox="0 0 24 24" stroke-width="2" stroke-linejoin="round" stroke-linecap="round" stroke="currentColor" height="24" fill="none" class="svg"><line y2="19" y1="5" x2="12" x1="12"></line><line y2="12" y1="12" x2="19" x1="5"></line></svg>
                    </div>
                </button>
            </a>

       </div>
       @* table  *@  
       @if(Model!=null && Model.Any()){
            <div class="rounded  p-2">
                <table class="table table-bordered table-dark  rounded-circle table-hover">
                    <thead>
                        <tr>
                            <th scope="col">Proj.ID</th>
                            <th scope="col">Project Title</th>
                            <th scope="col">Project Description</th>
                            <th scope="col">Start Date</th>
                            <th scope="col">End Date</th>
                            <th scope="col">Status</th>
                            <th scope="col">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var project in Model)
                        {
                            <tr>
                                <td>@project.ProjectId</td>
                                <td>@project.ProjectTitle</td>
                                <td>@project.ProjectDescription</td>
                                <td>@project.StartDate</td>
                                <td>@project.EndDate</td>
                                <td>
                                    @if (project.Status == "Not Started")
                                    {
                                        <div class="border border-secondary rounded-3 p-2 text-secondary">
                                            Not Started
                                        </div>
                                    }
                                    else if (project.Status == "In Progress")
                                    {
                                        <div class="border border-info rounded-3 p-2 text-info">
                                            In Progress
                                        </div>
                                    }
                                    else if (project.Status == "On hold")
                                    {
                                        <div class="border border-warning rounded-3 p-2  text-warning">
                                            <span>On hold</span>
                                        </div>
                                    }
                                    else if (project.Status == "Completed")
                                    {
                                        <div class="border border-success rounded-3 p-2 text-success">
                                            Completed
                                        </div>
                                    }
                                </td>

                                <td>
                                    <div class="d-flex">
                                        @* edit button  *@
                                        <button title="Edit" class="btn btn-light text-black"><a class="text-decoration-none text-dark" asp-controller="AdminProject" asp-action="EditProject" asp-route-id="@project.ProjectId"><span><i class='bx bx-edit-alt'></i></span></a></button>
                                        @* delete button  *@
                                        <form method="post" asp-controller="AdminProject" asp-action="DeleteProject" asp-route-id="@project.ProjectId" class="ms-1">
                                            <button type="submit" class="btn btn-danger text-light" title="Delete">
                                                <i class="bx bxs-trash"></i>
                                            </button>
                                        </form>

                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
                <a asp-action="ExportToExcel" class="btn btn-primary">Export All Projects to Excel<i class='bx bxs-file-export'></i></a>
            </div>
       } 
       @* not found mssg card  *@
       else{
            <div class="terminal-loader">
                <div class="terminal-header">
                    <div class="terminal-title">Status</div>
                    <div class="terminal-controls">
                        <div class="control close"></div>
                        <div class="control minimize"></div>
                        <div class="control maximize"></div>
                    </div>
                </div>
                <div class="text">No Data...</div>
            </div>

       }
</div> 
</body>  

<script>
    // Wait until the page is fully loaded
    window.onload = function() {
        // Check if the success message exists
        var alertBox = document.getElementById('success-alert');
        if (alertBox) {
            // Set a timeout to hide the alert after 3 seconds (3000 milliseconds)
            setTimeout(function () {
                alertBox.style.display = 'none';
            }, 3000);
        }
    }
</script>
</html>